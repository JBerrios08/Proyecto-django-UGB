{% extends "base.html" %}
{% load static %}

{% block title %}{{ title|default:"Sportline - Ropa Deportiva" }}{% endblock %}

{% block loader %}
<div id="loader" class="loader-overlay">
    <img src="{% static 'catalogo/carga.jpg' %}" alt="Cargando..." class="loader-img">
</div>
{% endblock %}

{% block nav_links %}
<ul class="navbar-nav me-auto mb-2 mb-lg-0">
    <li class="nav-item">
        <a class="nav-link {% if not filtro_actual %}active{% endif %}" href="{% url 'landing_catalogo' %}">
            <i class="fa-solid fa-list-ul me-1"></i> Todos
        </a>
    </li>
    {% for t in tipos %}
    <li class="nav-item">
        <a class="nav-link {% if filtro_actual == t %}active{% endif %}" href="{% url 'landing_catalogo' %}?tipo={{ t }}">
            <i class="fa-solid fa-tag me-1"></i> {{ t|capfirst }}
        </a>
    </li>
    {% endfor %}
</ul>
{% endblock %}

{% block content %}
<header class="position-relative text-white mb-0">
    <img src="{% static 'catalogo/banner_sportline.webp' %}" alt="Catálogo Sportline" class="img-fluid w-100" style="height: auto; width: 100%; display: block;">
    <div class="position-absolute top-0 start-0 w-100 h-100" style="background: rgba(0,0,0,0.25);"></div>
    <div class="position-absolute top-50 start-50 translate-middle text-center">
        <h1 class="mb-1">
            <i class="fa-solid fa-bolt me-2"></i>CATÁLOGO SPORTLINE
        </h1>
        <p class="mb-0">{{ slogan }}</p>
    </div>
</header>

<div class="container py-5">
    <div class="row g-4">
        {% for p in productos %}
        <div class="col-md-3 col-sm-6">
            <div class="card catalog-card h-100 shadow-sm">
                <img src="{% static p.imagen %}" class="square-img" alt="{{ p.nombre }}">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title mb-1">{{ p.nombre }}</h5>
                    <span class="badge bg-secondary badge-categoria mb-2">
                        <i class="fa-solid fa-layer-group me-1"></i> {{ p.categoria }}
                    </span>
                    <p class="small text-muted">{{ p.descripcion }}</p>
                    {% if p.color %}
                    <p class="mb-1"><strong>Color:</strong> {{ p.color }}</p>
                    {% endif %}
                    {% if p.talla %}
                    <p class="mb-1"><strong>Tallas:</strong> {{ p.talla }}</p>
                    {% endif %}

                    {% if p.precio_oferta %}
                    <p class="mb-1">
                        <span class="text-muted text-decoration-line-through">
                            <i class="fa-solid fa-dollar-sign me-1"></i>{{ p.precio|floatformat:2 }}
                        </span>
                    </p>
                    <p class="price-tag mb-3">
                        <i class="fa-solid fa-dollar-sign me-1"></i>{{ p.precio_oferta|floatformat:2 }}
                        <span class="badge badge-oferta ms-2">OFERTA</span>
                    </p>
                    {% else %}
                    <p class="price-tag mb-3">
                        <i class="fa-solid fa-dollar-sign me-1"></i>{{ p.precio|floatformat:2 }}
                    </p>
                    {% endif %}

                    <div class="mt-auto">
                        <a href="{% url 'agregar_carrito' p.id %}" class="btn btn-card w-100">
                            <i class="fa-solid fa-cart-plus me-1"></i>Añadir al carrito
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="alert alert-warning text-center">
                No hay productos en esta categoría.
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    window.addEventListener('load', () => {
        setTimeout(() => {
            const loader = document.getElementById('loader');
            if (loader) {
                loader.style.opacity = '0';
                loader.style.transition = 'opacity 250ms ease-out';
                setTimeout(() => loader.remove(), 280);
            }
        }, 800);
    });
</script>
{% endblock %}
